webpackJsonp([1],{740:function(e,t,n){n(777);var a=n(20)(n(752),n(789),null,null);e.exports=a.exports},752:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(158),i=a(r),o=n(157),l=a(o),s=n(156),c=a(s),u=n(783),f=a(u);t.default={components:{SearchSelect:f.default},data:function(){return{filters:{},orders:[],pageNum:1,pageSize:10,total:0,addUserinfo:{quantity:0,unit_price:0},addDialog:!1,editDialog:!1,editUserinfo:{},feeArray:[],FeeFieldOptions:[]}},created:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.getOrders(),t.next=3,e.$axios("FeeField/",{params:{page:1,page_size:1e3}});case 3:n=t.sent,e.FeeFieldOptions=n.data;case 5:case"end":return t.stop()}},t,e)}))()},methods:{handleCurrentChange:function(e){this.page=e,this.getOrders()},getOrders:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios("ChannelRate/",{params:{search:e.filters.name,page:e.page}});case 2:n=t.sent,console.log(n),e.orders=n.data,e.total=n.count;case 6:case"end":return t.stop()}},t,e)}))()},handleEdit:function(e,t){this.editDialog=!0,this.editUserinfo=(0,i.default)({},t),this.getChannelEffectiveTime()},delChannelEffectiveTime:function(e,t){var n=this;return(0,c.default)(l.default.mark(function a(){var r;return l.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.$axios.delete("ChannelEffectiveTime/"+e.id);case 2:r=a.sent,n.$message.success(r.message),n.feeArray.splice(t,1);case 5:case"end":return a.stop()}},a,n)}))()},getChannelEffectiveTime:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n,a;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.feeArray.splice(0,e.feeArray.length),t.next=3,e.$axios("ChannelEffectiveTime?chanel_id="+e.editUserinfo.id);case 3:n=t.sent,a=n.data,e.feeArray=a;case 6:case"end":return t.stop()}},t,e)}))()},addChannel:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n,a;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post("ChannelEffectiveTime/",{chanel_id:e.editUserinfo.id});case 2:n=t.sent,a=n.data,e.feeArray.push(a);case 5:case"end":return t.stop()}},t,e)}))()},delOrder:function(e,t){var n=this;return(0,c.default)(l.default.mark(function e(){var a;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.$axios.delete("ChannelRate/"+t.id);case 2:a=e.sent,console.log(a),n.getOrders();case 5:case"end":return e.stop()}},e,n)}))()},addUser:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post("ChannelRate/",e.addUserinfo);case 2:n=t.sent,e.addDialog=!1,e.getOrders();case 5:case"end":return t.stop()}},t,e)}))()},editUser:function(){var e=this;return(0,c.default)(l.default.mark(function t(){var n;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.put("ChannelRate/"+e.editUserinfo.id+"/",e.editUserinfo);case 2:n=t.sent,console.log(n),e.editDialog=!1,e.getOrders();case 6:case"end":return t.stop()}},t,e)}))()}}}},760:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(157),i=a(r),o=n(156),l=a(o);t.default={name:"ChannelEffectiveTimeSearchSelect",props:{ChannelEffectiveTime:{type:Object},FeeFieldOptions:{type:Array}},data:function(){return{options:[],value:[],list:[],loading:!1,datetimerange:["",""]}},created:function(){var e=this;return(0,l.default)(i.default.mark(function t(){var n;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=0;n<e.ChannelEffectiveTime.fee_field.length;n++)e.value.push(e.ChannelEffectiveTime.fee_field[n].id);e.ChannelEffectiveTime.time_start&&(e.datetimerange[0]=e.ChannelEffectiveTime.time_start),e.ChannelEffectiveTime.time_end&&(e.datetimerange[1]=e.ChannelEffectiveTime.time_end),e.options=e.FeeFieldOptions;case 4:case"end":return t.stop()}},t,e)}))()},mounted:function(){var e=this;return(0,l.default)(i.default.mark(function t(){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},methods:{selChange:function(e){var t=this;return(0,l.default)(i.default.mark(function n(){var a,r,o;return i.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.$emit("selChange",e),console.log(t.value),t.loading=!0,a={},a.fee_field=t.value,n.next=7,t.$axios.patch("ChannelEffectiveTime/"+t.ChannelEffectiveTime.id+"/",a);case 7:r=n.sent,o=r.data,t.loading=!1;case 10:case"end":return n.stop()}},n,t)}))()},dateChange:function(){var e=this;return(0,l.default)(i.default.mark(function t(){var n,a,r;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={},n.time_start=e.datetimerange[0],n.time_end=e.datetimerange[1],n.id=e.ChannelEffectiveTime.id,t.next=6,e.$axios.post("ChannelEffectiveTime/update_effective_time/",n);case 6:a=t.sent,r=a.message,e.$message.success(r);case 9:case"end":return t.stop()}},t,e)}))()},remoteMethod:function(e){var t=this;return(0,l.default)(i.default.mark(function n(){var a,r,o,l;return i.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""===e){n.next=10;break}return t.loading=!0,n.next=4,t.$axios("FeeField/",{params:{search:e,page:t.page}});case 4:a=n.sent,r=a.data,t.options=r,t.loading=!1,n.next=15;break;case 10:return n.next=12,t.$axios("FeeField/");case 12:o=n.sent,l=o.data,t.options=l;case 15:case"end":return n.stop()}},n,t)}))()}}}},766:function(e,t,n){t=e.exports=n(738)(),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"ChannelEffectiveTimeSearchSelect.vue",sourceRoot:""}])},768:function(e,t,n){t=e.exports=n(738)(),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Channel.vue",sourceRoot:""}])},775:function(e,t,n){var a=n(766);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(739)("f5259de2",a,!0)},777:function(e,t,n){var a=n(768);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(739)("1a83dd3c",a,!0)},783:function(e,t,n){n(775);var a=n(20)(n(760),n(787),null,null);e.exports=a.exports},787:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-form",{attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选择费率字段"}},[n("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":e.remoteMethod,loading:e.loading,multiple:""},on:{change:e.selChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(t){return n("el-option",{key:t.id,attrs:{label:""+t.name+t.fee+"%",value:t.id}},[n("span",{staticStyle:{float:"left","font-size":"11px"}},[e._v(e._s(t.name))]),e._v(" "),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"11px"}},[e._v(e._s(t.fee))])])}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"生效日期"}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:e.dateChange},model:{value:e.datetimerange,callback:function(t){e.datetimerange=t},expression:"datetimerange"}})],1)],1)],1)},staticRenderFns:[]}},789:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[n("el-form",{attrs:{inline:!0,model:e.filters}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"用户名称"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getOrders.apply(null,arguments)}},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.getOrders}},[e._v("查询")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialog=!0}}},[e._v("新增")])],1)],1)],1),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orders,"highlight-current-row":""}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"chanel",label:"渠道",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return e.delOrder(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-col",{staticClass:"toolbar",attrs:{span:24}},[n("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),n("el-dialog",{attrs:{title:"新增渠道",visible:e.addDialog},on:{"update:visible":function(t){e.addDialog=t}}},[n("el-form",{staticClass:"demo-form-inline",attrs:{model:e.addUserinfo,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"渠道"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addUserinfo.chanel,callback:function(t){e.$set(e.addUserinfo,"chanel",t)},expression:"addUserinfo.chanel"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser()}}},[e._v("提交")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"编辑渠道",visible:e.editDialog},on:{"update:visible":function(t){e.editDialog=t}}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addChannel()}}},[e._v(" 增加渠道费率 ")]),e._v(" "),n("el-form",{staticClass:"demo-form-inline",attrs:{model:e.editUserinfo,"label-width":"180px",inline:!0}},[n("el-form-item",{attrs:{label:"渠道"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editUserinfo.chanel,callback:function(t){e.$set(e.editUserinfo,"chanel",t)},expression:"editUserinfo.chanel"}})],1)],1),e._v(" "),e._l(e.feeArray,function(t,a){return n("div",{key:a,staticStyle:{"border-bottom":"1px solid gray","margin-top":"25px",display:"flex"}},[n("div",{staticStyle:{width:"90%",dispaly:"inline-block"}},[n("search-select",{attrs:{ChannelEffectiveTime:t,FeeFieldOptions:e.FeeFieldOptions}})],1),e._v(" "),n("el-button",{staticStyle:{height:"35px"},on:{click:function(n){return e.delChannelEffectiveTime(t,a)}}},[e._v("删除")])],1)}),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.editDialog=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUser()}}},[e._v("提交")])],1)],2)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=1.1345aebc57c4c34b1d1a.js.map